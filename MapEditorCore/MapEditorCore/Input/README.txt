Input by Jani Niemelä. From NeVa SaNi game engine.